CuPy-AMD
========

## 1. Build a Docker image

```bash
sudo docker build -t cupy-amd .
```

## 2. Try CuPy on AMD GPUs


### Run a small example of CuPy

```bash
docker run --rm -ti \
--device=/dev/kfd \
--device=/dev/dri \
--group-add video \
cupy-amd \
python3 cupy/examples/gemm/sgemm.py
```

### Run the MNIST example on Vega 10 GPU

```bash
docker run --rm -ti \
--device=/dev/kfd \
--device=/dev/dri \
--group-add video \
cupy-amd \
python3 chainer/examples/mnist/train_mnist.py -g 0
```

Output:
```
# unit: 1000
# Minibatch-size: 100
# epoch: 20

epoch       main/loss   validation/main/loss  main/accuracy  validation/main/accuracy  elapsed_time
1           0.191636    0.104016              0.941749       0.9677                    14.0415       
2           0.0725324   0.0809784             0.977365       0.9736                    17.9653       
3           0.0483136   0.07426               0.984282       0.9781                    21.9157       
4           0.0356667   0.0665017             0.988582       0.9802                    25.8826       
5           0.029242    0.0783757             0.990431       0.976                     29.8337       
6           0.0240914   0.0915075             0.991882       0.976                     33.7948       
7           0.0202024   0.070404              0.993548       0.9807                    37.726        
8           0.0171451   0.0737094             0.994632       0.9824                    41.7049       
9           0.0175979   0.0860599             0.994165       0.9818                    45.6674       
10          0.0174146   0.08188               0.994615       0.9804                    49.6225       
11          0.013079    0.078925              0.995815       0.9824                    53.5648       
12          0.0110601   0.0960848             0.996232       0.9828                    57.5095       
13          0.0115849   0.0925806             0.996599       0.9822                    61.4513       
14          0.014988    0.0839504             0.995399       0.9818                    65.4373       
15          0.0106209   0.0794084             0.996682       0.9832                    69.4073       
16          0.00842235  0.10651               0.997649       0.9803                    73.3788       
17          0.00726848  0.102539              0.997733       0.9815                    77.3515       
18          0.0119389   0.0910986             0.996699       0.9838                    81.3353       
19          0.0109424   0.0907164             0.997066       0.983                     85.3474       
20          0.00757545  0.107515              0.997699       0.9802                    89.3063       
```

### Run the MNIST example on a CPU

```bash
docker run --rm -ti \
--device=/dev/kfd \
--device=/dev/dri \
--group-add video \
cupy-amd \
python3 chainer/examples/mnist/train_mnist.py
```

Output:
```
# unit: 1000
# Minibatch-size: 100
# epoch: 20

epoch       main/loss   validation/main/loss  main/accuracy  validation/main/accuracy  elapsed_time
1           0.187704    0.0937206             0.9432         0.9695                    17.1154       
2           0.0730435   0.0852911             0.977933       0.9738                    36.2074       
3           0.0501799   0.0680568             0.983733       0.9793                    56.8593       
4           0.0354176   0.0646633             0.988733       0.9774                    78.3881       
5           0.0270825   0.0732161             0.99115        0.9794                    100.331       
6           0.0267942   0.103403              0.991367       0.9741                    122.597       
7           0.0201187   0.0725997             0.993517       0.9804                    145.212       
8           0.0182543   0.0835362             0.994433       0.9829                    168.429       
9           0.0157531   0.0964543             0.994917       0.9771                    192.354       
10          0.0168626   0.0969066             0.995033       0.9776                    216.786       
11          0.0119452   0.101312              0.9961         0.9804                    241.711       
12          0.0166173   0.0862826             0.994917       0.981                     267.103       
13          0.0122933   0.081194              0.99625        0.9815                    293.385       
14          0.010662    0.0848452             0.9969         0.9831                    320.661       
15          0.0103436   0.10535               0.996683       0.9796                    348.777       
16          0.0133214   0.0950927             0.995917       0.9814                    377.718       
17          0.0100858   0.0849069             0.99695        0.9825                    406.066       
18          0.00672406  0.0913459             0.998          0.9841                    436.876       
19          0.00958619  0.0917329             0.99715        0.9854                    468.3         
20          0.00701251  0.0980348             0.997917       0.9832                    499.412       
```